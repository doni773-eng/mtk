<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vektor Interaktif Lengkap + Animasi</title>
<style>
/* BAGIAN BACKGROUND BARU */
body {
    font-family: 'Segoe UI', Arial, sans-serif;
    margin: 0;
    padding: 20px;
    /* Background Gradient Animasi */
    background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
    background-size: 400% 400%;
    animation: gradient 15s ease infinite;
    min-height: 100vh;
}

@keyframes gradient {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

/* Pola Grid Overlay agar terlihat seperti buku matematika */
body::before {
    content: "";
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background-image: radial-gradient(rgba(255,255,255,0.1) 1px, transparent 1px);
    background-size: 20px 20px;
    z-index: -1;
}

h2 {
    text-align: center;
    color: white;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    font-size: 2em;
    margin-bottom: 30px;
}

.card {
    background: rgba(255, 255, 255, 0.95); /* Sedikit transparan agar background tembus */
    padding: 20px;
    margin: 0 auto 20px auto;
    max-width: 600px;
    border-radius: 15px;
    box-shadow: 0 8px 32px rgba(0,0,0,0.2);
    backdrop-filter: blur(5px); /* Efek kaca */
    border: 1px solid rgba(255,255,255,0.3);
}

h3 {
    color: #333;
    border-bottom: 2px solid #007bff;
    padding-bottom: 5px;
    display: inline-block;
}

input {
    width: 60px;
    padding: 8px;
    margin: 3px;
    border: 2px solid #eee;
    border-radius: 8px;
    text-align: center;
    font-weight: bold;
}

input:focus {
    border-color: #007bff;
    outline: none;
}

button {
    padding: 10px 16px;
    border: none;
    border-radius: 8px;
    background: #007bff;
    color: #fff;
    font-weight: bold;
    cursor: pointer;
    transition: 0.3s;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
}

button:hover {
    background: #0056b3;
    transform: scale(1.05);
}

.result {
    margin-top: 15px;
    background: #f0f7ff;
    padding: 15px;
    border-radius: 10px;
    border-left: 5px solid #007bff;
    font-size: 16px;
    color: #333;
}

canvas {
    border: 3px solid #f0f0f0;
    background: #fff;
    width: 100%;
    max-width: 450px;
    height: auto;
    display: block;
    margin: 15px auto;
    border-radius: 12px;
    cursor: grab;
    box-shadow: inset 0 0 10px rgba(0,0,0,0.05);
}

.controls {
    text-align: center;
    margin-top: 8px;
    color: #555;
    font-weight: bold;
}

.vektor {
    display: inline-grid;
    grid-template-columns: auto auto auto;
    gap: 4px;
    font-weight: bold;
    vertical-align: middle;
}

.vektor .isi {
    display: grid;
    grid-template-rows: auto auto;
    text-align: center;
}

.kurung {
    font-size: 1.2em;
    display: inline-block;
    transform-origin: center;
}
</style>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>

<h2>üìê Vektor Interaktif</h2>

<div class="card">
<h3>1Ô∏è‚É£ Vektor Negatif</h3>
<div>
\(\vec{a}\) = (<input id="ax" placeholder="x"> , <input id="ay" placeholder="y">)
<button onclick="negatif()">Cari</button>
</div>
<div class="result" id="hasilNegatif"></div>
</div>

<div class="card">
<h3>2Ô∏è‚É£ Vektor Posisi</h3>
<div>
\(\vec{OA}\) = (<input id="px" placeholder="x"> , <input id="py" placeholder="y">)
<button onclick="posisi()">Cari</button>
</div>
<div class="result" id="hasilPosisi"></div>
</div>

<div class="card">
<h3>3Ô∏è‚É£ Vektor Non Posisi (Animasi)</h3></br>
\(\vec{OA}\) = (<input id="oax" placeholder="x1"> , <input id="oay" placeholder="y1">)<br>
\(\vec{OB}\) = (<input id="obx" placeholder="x2"> , <input id="oby" placeholder="y2">)<br>
<button onclick="nonPosisi()" style="margin-top:10px">Hitung & Gambar</button>
<div class="result" id="hasilAB"></div>
<canvas id="kanvasNP"></canvas>
<div class="controls">Zoom: <input type="range" id="zoomNP" min="10" max="80" value="30"> <span id="zNP">30</span></div>
</div>

<div class="card">
<h3>4Ô∏è‚É£ Operasi Vektor (Animasi)</h3></br>
\(\vec{a}\) = (<input id="ax2" placeholder="ax"> , <input id="ay2" placeholder="ay">)<br>
\(\vec{b}\) = (<input id="bx2" placeholder="bx"> , <input id="by2" placeholder="by">)<br>
<div style="margin-top:10px">
    <button onclick="jumlah()">a + b</button>
    <button onclick="kurang()">a ‚àí b</button>
</div>
<div class="result" id="hasilJumlah"></div>
<canvas id="kanvasOP"></canvas>
<div class="controls">Zoom: <input type="range" id="zoomOP" min="10" max="200" value="50"> <span id="zOP">50</span></div>
</div>

<script>
// --- JAVASCRIPT ASLI KAMU (TIDAK DIUBAH SAMA SEKALI) ---
function vHTML(x,y){
    let lenX=x.toString().length, lenY=y.toString().length;
    let maxLen=Math.max(lenX,lenY);
    let scale=1.2+(maxLen-1)*0.08;
    if(scale>2) scale=2;
    return `<span class="vektor">
        <span class="kurung" style="transform: scaleX(${scale})">(</span>
        <span class="isi"><span>${x}</span><span>${y}</span></span>
        <span class="kurung" style="transform: scaleX(${scale})">)</span>
    </span>`;
}

function ambilNilai(id) {
    let val = document.getElementById(id).value;
    if (val.trim() === "") {
        alert("Mohon isi semua kolom input terlebih dahulu.");
        throw new Error("Input kosong");
    }
    return +val;
}

function negatif(){
    try {
        let x=ambilNilai('ax'), y=ambilNilai('ay');
        let langkah=`Langkah mencari vektor negatif:<br>`;
        langkah+=`1. Komponen x: -(${x}) = ${-x}<br>`;
        langkah+=`2. Komponen y: -(${y}) = ${-y}<br>`;
        langkah+=`Hasil: \\( \\vec{a} \\) = ${vHTML(x,y)} , \\( -\\vec{a} \\) = ${vHTML(-x,-y)}`;
        hasilNegatif.innerHTML = langkah;
        MathJax.typeset();
    } catch(e) {}
}

function posisi(){
    try {
        let x=ambilNilai('px'), y=ambilNilai('py');
        let langkah=`Langkah menentukan vektor posisi OA:<br>`;
        langkah+=`x = ${x}, y = ${y}<br>`;
        langkah+=`Hasil: \\( \\vec{OA} \\) = ${vHTML(x,y)}`;
        hasilPosisi.innerHTML=langkah;
        MathJax.typeset();
    } catch(e) {}
}

function setupCanvas(id){
    let c=document.getElementById(id);
    c.width=c.clientWidth;
    c.height=c.clientWidth;
    let ctx=c.getContext("2d");
    return {c,ctx,scale:30,ox:c.width/2,oy:c.height/2,drag:false,x0:0,y0:0};
}

let NP=setupCanvas("kanvasNP");
let dataNP=null;
let animIdNP = null;

let OP=setupCanvas("kanvasOP");
let dataOP=null;
let animIdOP = null;

function drawGrid(ctx, ox, oy, scale, showAxes = true){
    const w = ctx.canvas.width;
    const h = ctx.canvas.height;
    ctx.clearRect(0, 0, w, h);
    ctx.font="10px Arial";
    ctx.textAlign="start";
    ctx.textBaseline="top";

    let startX = ox % scale;
    for(let x = startX; x < w; x += scale){
        ctx.strokeStyle = "#ddd";
        ctx.lineWidth = 1;
        ctx.beginPath(); ctx.moveTo(x, 0); ctx.lineTo(x, h); ctx.stroke();
        if(showAxes) {
            let valX = Math.round((x - ox) / scale);
            if(valX !== 0) { ctx.fillStyle = "#888"; ctx.fillText(valX, x + 2, oy + 2); }
        }
    }

    let startY = oy % scale;
    for(let y = startY; y < h; y += scale){
        ctx.strokeStyle = "#ddd";
        ctx.lineWidth = 1;
        ctx.beginPath(); ctx.moveTo(0, y); ctx.lineTo(w, y); ctx.stroke();
        if(showAxes) {
            let valY = Math.round((oy - y) / scale);
            if(valY !== 0) { ctx.fillStyle = "#888"; ctx.fillText(valY, ox + 2, y + 2); }
        }
    }

    if(showAxes) {
        ctx.strokeStyle="#000"; ctx.lineWidth=1.5;
        ctx.beginPath(); ctx.moveTo(0, oy); ctx.lineTo(w, oy); ctx.stroke();
        ctx.beginPath(); ctx.moveTo(ox, 0); ctx.lineTo(ox, h); ctx.stroke();
        ctx.fillStyle="#000"; ctx.fillText("0", ox+2, oy+2);
    }
}

function drawVector(ctx,ox,oy,scale,x1,y1,x2,y2,color,label, progress = 1.0){
    let X1=ox+x1*scale, Y1=oy-y1*scale;
    let curX2 = x1 + (x2 - x1) * progress;
    let curY2 = y1 + (y2 - y1) * progress;
    let X2=ox+curX2*scale, Y2=oy-curY2*scale;

    ctx.fillStyle = "#000";
    ctx.beginPath();
    ctx.arc(X1, Y1, 3.5, 0, Math.PI * 2);
    ctx.fill();

    ctx.strokeStyle=color; 
    ctx.lineWidth=2;
    ctx.beginPath(); ctx.moveTo(X1,Y1); ctx.lineTo(X2,Y2); ctx.stroke();

    ctx.fillStyle=color;
    let head=8*(scale/30), a=Math.atan2(Y2-Y1,X2-X1);
    ctx.beginPath(); ctx.moveTo(X2,Y2);
    ctx.lineTo(X2-head*Math.cos(a-Math.PI/6), Y2-head*Math.sin(a-Math.PI/Head));
    ctx.lineTo(X2-head*Math.cos(a+Math.PI/6), Y2-head*Math.sin(a+Math.PI/6));
    ctx.closePath(); ctx.fill();

    if(progress >= 1.0) {
        let midX = (X1 + X2) / 2;
        let midY = (Y1 + Y2) / 2;
        ctx.font="bold 13px Arial";
        ctx.textAlign="center";
        ctx.textBaseline="middle";
        ctx.strokeStyle = "white";
        ctx.lineWidth = 3;
        ctx.strokeText(label, midX, midY);
        ctx.fillStyle = color;
        ctx.fillText(label, midX, midY);
    }
}

function redrawNP(){
    if(animIdNP) cancelAnimationFrame(animIdNP);
    drawGrid(NP.ctx, NP.ox, NP.oy, NP.scale, true);
    if(!dataNP) return;
    drawVector(NP.ctx,NP.ox,NP.oy,NP.scale,0,0,dataNP.a.x,dataNP.a.y,"blue","OA");
    drawVector(NP.ctx,NP.ox,NP.oy,NP.scale,0,0,dataNP.b.x,dataNP.b.y,"green","OB");
    drawVector(NP.ctx,NP.ox,NP.oy,NP.scale,dataNP.a.x,dataNP.a.y,dataNP.b.x,dataNP.b.y,"red","AB");
}

function animateNP() {
    if(animIdNP) cancelAnimationFrame(animIdNP);
    let start = null;
    function step(ts) {
        if(!start) start = ts;
        let p = (ts - start) / 1500;
        if(p > 1) p = 1;
        drawGrid(NP.ctx, NP.ox, NP.oy, NP.scale, true);
        drawVector(NP.ctx,NP.ox,NP.oy,NP.scale,0,0,dataNP.a.x,dataNP.a.y,"blue","OA", Math.min(1, p*3));
        if(p > 0.33) drawVector(NP.ctx,NP.ox,NP.oy,NP.scale,0,0,dataNP.b.x,dataNP.b.y,"green","OB", Math.min(1, (p-0.33)*3));
        if(p > 0.66) drawVector(NP.ctx,NP.ox,NP.oy,NP.scale,dataNP.a.x,dataNP.a.y,dataNP.b.x,dataNP.b.y,"red","AB", Math.min(1, (p-0.66)*3));
        if(p < 1) animIdNP = requestAnimationFrame(step);
    }
    animIdNP = requestAnimationFrame(step);
}

function redrawOP(){
    if(animIdOP) cancelAnimationFrame(animIdOP);
    drawGrid(OP.ctx, OP.ox, OP.oy, OP.scale, false);
    if(!dataOP) return;
    let dx = (dataOP.t==="+" ? dataOP.a.x + dataOP.b.x : dataOP.a.x - dataOP.b.x);
    let dy = (dataOP.t==="+" ? dataOP.a.y + dataOP.b.y : dataOP.a.y - dataOP.b.y);
    drawVector(OP.ctx,OP.ox,OP.oy,OP.scale,0,0,dataOP.a.x,dataOP.a.y,"blue","a");
    drawVector(OP.ctx,OP.ox,OP.oy,OP.scale,dataOP.a.x,dataOP.a.y,dx,dy,"green",dataOP.t==="+"?"b":"-b");
    drawVector(OP.ctx,OP.ox,OP.oy,OP.scale,0,0,dx,dy,"red","hasil");
}

function animateOP() {
    if(animIdOP) cancelAnimationFrame(animIdOP);
    let start = null;
    function step(ts) {
        if(!start) start = ts;
        let p = (ts - start) / 1500;
        if(p > 1) p = 1;
        drawGrid(OP.ctx, OP.ox, OP.oy, OP.scale, false);
        let curDx = (dataOP.t==="+" ? dataOP.a.x + dataOP.b.x : dataOP.a.x - dataOP.b.x);
        let curDy = (dataOP.t==="+" ? dataOP.a.y + dataOP.b.y : dataOP.a.y - dataOP.b.y);
        drawVector(OP.ctx,OP.ox,OP.oy,OP.scale,0,0,dataOP.a.x,dataOP.a.y,"blue","a", Math.min(1, p*3));
        if(p > 0.33) drawVector(OP.ctx,OP.ox,OP.oy,OP.scale,dataOP.a.x,dataOP.a.y,curDx,curDy,"green",dataOP.t==="+"?"b":"-b", Math.min(1, (p-0.33)*3));
        if(p > 0.66) drawVector(OP.ctx,OP.ox,OP.oy,OP.scale,0,0,curDx,curDy,"red","hasil", Math.min(1, (p-0.66)*3));
        if(p < 1) animIdOP = requestAnimationFrame(step);
    }
    animIdOP = requestAnimationFrame(step);
}

function nonPosisi(){
    try {
        let a={x:ambilNilai('oax'), y:ambilNilai('oay')};
        let b={x:ambilNilai('obx'), y:ambilNilai('oby')};
        dataNP={a,b};
        let dx=b.x-a.x, dy=b.y-a.y;
        hasilAB.innerHTML=`Langkah mencari vektor AB:<br>1. Komponen x: ${b.x} - ${a.x} = ${dx}<br>2. Komponen y: ${b.y} - ${a.y} = ${dy}<br>Hasil: \\( \\vec{AB} \\) = ${vHTML(dx,dy)}`;
        MathJax.typeset(); animateNP();
    } catch(e) {}
}

function jumlah(){ setupOPData("+"); }
function kurang(){ setupOPData("-"); }

function setupOPData(tipe){
    try {
        let a={x:ambilNilai('ax2'), y:ambilNilai('ay2')};
        let b={x:ambilNilai('bx2'), y:ambilNilai('by2')};
        dataOP={a,b,t:tipe};
        let dx = (tipe==="+" ? a.x + b.x : a.x - b.x);
        let dy = (tipe==="+" ? a.y + b.y : a.y - b.y);
        let opSign = tipe==="+" ? "+" : "-";
        hasilJumlah.innerHTML=`Langkah ${tipe==="+"?"Jumlah":"Kurang"}:<br>1. x: ${a.x} ${opSign} ${b.x} = ${dx}<br>2. y: ${a.y} ${opSign} ${b.y} = ${dy}<br>Hasil: ${vHTML(dx,dy)}`;
        MathJax.typeset(); animateOP();
    } catch(e) {}
}

zoomNP.oninput=()=>{NP.scale=+zoomNP.value; zNP.textContent=zoomNP.value; redrawNP();}
zoomOP.oninput=()=>{OP.scale=+zoomOP.value; zOP.textContent=zoomOP.value; redrawOP();}

function makeDraggable(o){
    let c=o.c;
    const start = (x, y) => { o.drag=true; o.x0=x; o.y0=y; };
    const move = (x, y) => {
        if(o.drag){
            o.ox += x - o.x0; o.oy += y - o.y0;
            o.x0 = x; o.y0 = y;
            o === NP ? redrawNP() : redrawOP();
        }
    };
    c.onmousedown=e=>start(e.offsetX, e.offsetY);
    window.onmouseup=()=>o.drag=false;
    c.onmousemove=e=>move(e.offsetX, e.offsetY);
    c.ontouchstart=e=>{ if(e.touches.length===1) start(e.touches[0].clientX, e.touches[0].clientY); };
    c.ontouchmove=e=>{ if(o.drag && e.touches.length===1) { move(e.touches[0].clientX, e.touches[0].clientY); e.preventDefault(); } };
    c.ontouchend=()=>o.drag=false;
}

makeDraggable(NP); makeDraggable(OP);
window.onload = () => { drawGrid(NP.ctx, NP.ox, NP.oy, NP.scale, true); drawGrid(OP.ctx, OP.ox, OP.oy, OP.scale, false); };
</script>
</body>
</html>
